# flowable理论(一) 工作流理论

## 一、工作流是什么

​	工作的一个流程，事物发展的一个业务过程

- 请假流程：员工申请——部门经理——总经理——人事存档

  传统方式？请假条的传递方式实现

  无纸化办工？ 线上申请——线上审批——数据库可形成一条请假记录

  在计算机的帮助下，能够实现流程的自动化控制，就称为工作流

​	“在一个工作群组中，为了达成某一个共同目的而需要多人协力以循序或平行工作的形式来共同完成的任务”

## 二、为什么要用工作流引擎

为了实现自动化控制，Activiti引擎就产生了。

>工作流技术通过将工作分解成定义良好的任务、角色，按照一定的规则和过程来执行这些任务井对它们进行监控.可以提高办事效率、降低生产成本.提高企业生产经营管理水乎和企业的竞争力。实现现代企业经营过程自动化。

## 三、关于工作流的几个名词解释：

| 任务           | 泛指各种事务上所必需执行的流程性工作                         |
| -------------- | ------------------------------------------------------------ |
| 循序或平行工作 | 工作的流动性是一个人接着一个人执行，或同时由多人分开执行，或是上诉两类工作合并之后的混合性工作 |
| 多人           | 若是单人就可以完成的工作，则不能归类为流程工作。凡是一件工作必须经两个或更多人来协力完成的工作才能称为流程工作 |
| 共同的目的     | 多人参与的流程性工作，必须时以完成共同目的为前提。如果一群人是分别针对不同的专案来执行各别的工作，并不算构成一个工作流程 |

## 四、工作流程的应用范围

​	在与一般的组织活动中，由相当多数量的事务性工作可以被归类到流程性工作的范围里面，列举如下：

- 采购单流程
- 贷款审核流程
- 员工绩效考核流程
- 工作报表呈报流程
- 各类报表会签流程
- 人事管理类
- 客户服务类
- SaaS-人力资源管理系统



## 五、如何架构一个工作流程

​	首先要定义出一个在一个群组工作的环境下，所需要执行或管控的事务性工作性质及其内容。

根据所定义的工作内容，再将他分成许多子工作，或称为步骤。每个步骤都包含了在这个阶段所需要完成的项目清单，而且这些步骤内的项目应当是在逻辑上适合在同一步骤内完成的。任何一件流程工作都会有许多不同的方法来分解成许多子工作，**而如何切割一个流程工作**，则要根据实际的情况来做判断。

- 决定各个步骤需要那些专业背景的人员来执行；

- 决定各个步骤在流程执行时的顺序；

- 在执行的过程中，有些步骤的执行会因为某些条件不同产生不同的结果，进而影响到下一个步骤的执行。所以我们必须要找出这些特定的步骤，并且将祥光的执行条件定义清楚；

​	将工作流程中的所有执行步骤及每个步骤之间的关系图画出来，并且根据这份关系图来验证流程的可行性。

​	根据各个步骤的不同需求，分别建立各阶段所需要的表单，工作指令，文件......等项目。



## 六、工作流管理系统(WfMS)的三大功能模块

一般而言，所有的WfMS都将包含如下三大功能模块：建立时功能、运行时控制功能、同用户及应用程序的交互功能。

### 建立时功能

​	主要目标时通过某种分析、建模及系统定义手段将现实世界的业务过程转化为某种能够被计算机处理的形式化表示。

### 运行时实例控制功能

​	主要进行在某个计算环境中工作流过程中管理及各活动步骤之间的状态转换。运行时控制系统将解释过程定义，完成过程的可操作实例的创建及控制，调度过程中各活动步骤，并在合适的时机调用有关应用程序资源，

等等，这些服务我们一般就称为“工作流执行服务”，有些系统可能是通过一个工作流引擎提供这些服务，也可能使用多个工作流引擎。工作流引擎是工作流运行时控制系统的核心部分，各种过程实例的执行都是由它负责完成的。

### 运行时同用户及应用的交互功能

​	主要完成对工作流实例执行过程种各种活动的处理。

## 七、市面上有哪些工作流

国外开源与商业版本： 

轻量级工作流引擎（开源），如：Camunda，Activiti，JBoss jBPM。

BPM套件遵循“零代码”方法，如：IBM，Pega，Software AG。

带DSL的纯状态机，如：Amazon Simple Workflow，Netflix conductor。

简单的“事件反应机器”，如：IFTTT，Zapier，Microsoft Flow。 

大数据或ETL的数据流框架，如：Spring Cloud数据流，Apache Airflow。 

国产：商业化有普元、西安协同，北京的东方易维。 

国内开源：方正的fixflow，据于activity上二次开发的广州宏天、fixflow、jsite等。 

国内著名oa: 泛微oa、志远oa、通达oat等。

---



## 八、工作流的规范

WfMC: 1993年成立了工作流管理联盟，制定了WfMC规范（工作流参考模型）。 

BPMN1.0: 2004年5月,制定了工作流建模语言的规范，简称BPMN(Business Process Modeling Notation)**业务流程建模与标注**. 

**BPMN2.0**: 2011年推出BPMN2.0标准，2013年12月以推出BPMN2.0.2标准。目前的activity和flowable就是据于此标准进行的开发。

---



## 九、工作流框架的主要功能探讨

### 一、流程建模与管理功能 

1. web化的流程建模 BPMN2.0规范的支持，即节点（开始事件/结束事件节点，用户任务节点，服务节点，定时任务节点，会签节点等），路由（普通路由/并行网关/排他网关），子流程，条件，监听器，变量，规则，选人策略：执行人/候选人/候选组，流程表单/任务表单。

2. 版本管理 

3. 部署与发布 

4. 导入/导出 

### 二、流程实例管理功能 

1.启动/提前终止（即流程撤销）/正常结束 

2.挂起/激活恢复 

3.物理删除 

4.我发起的流程实例/我参与的流程实例 

### 三、任务实例管理功能 

1.待办/待签收 

2.在办/已签收在办 

3.完成任务 

4.转办任务（换当前办理人,或者叫变理当前办理人) 

5.委派（办理人的功劳要计在委托人名下）/工作代理 

6.驳回/退回上一步/退回至（即退回到历史某一个节点） 

7.撤回（未签收情况下） 

8.催办 

9.抄送 

### 四、流程监控与管理控制 

1.流程状态查询（活动中/提前终止/正常结束） 

2.挂起/激活恢复 

3.流程实例删除 

### 五、流程统计功能 

1.超时流程实例与任务 

2.发起与参与流程统计 

### 六、流程权限功能 

1.流程模板的授权 

2.表单操作授权 

3.流程按纽授权 

4.流程数据授权 

5.组织模型（用户/用户组，用户与用户组之间关系） 

### 七、表单设计器 

1.标签 

2.普通文本/大文本/富文本框 

3.下拉/单选/多选 

4.日期 

5.金额控件/整型控件/数字控件 

6.附件 

7.字典控件 

8.公用域控件 

9.表单编号控件 

10.表单标题/副标题控件



## 十、程序员简单编码来实现

1，工号，姓名，日期，天数，原因，状态 0未提交 1提交

员工：0未提交 1提交

部门：部门号=部门经理的部门编号相同，状态=1

​        2同意    3不同意

总经理： 状态 = 2查询条件

​		4同意	5不同意

人事存档  状态=4

​		6同意	7不同意



问题：业务流程变更后，程序不能使用，维护成本高

为什么Activiti就可以解决业务需求变更时，源代码不需要更新，更新的是业务流程图